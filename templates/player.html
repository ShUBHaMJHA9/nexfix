<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Stream your favorite content in high quality. Enjoy a seamless viewing experience with a vast library.">
    <meta name="keywords" content="streaming, video, entertainment, watch party">
    <meta name="robots" content="index, follow">
    <title>StreamX - Watch Together</title>
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">

    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/grid.css">
    <link rel="stylesheet" href="/assets/css/dash2.css">
    <link rel="stylesheet" href="/assets/css/chat.css">
</head>
<body>
    <!-- Navigation -->
    <div class="nav-wrapper">
        <div class="container">
            <div class="nav">
                <a href="#" class="logo">
                    <i class="bx bx-movie-play bx-tada main-color"></i>Stream<span class="main-color">X</span>
                </a>
                <div class="search-bar" id="search-bar">
                    <div class="search-input-wrapper">
                        <input type="text" placeholder="Search" id="search-input">
                    </div>
                    <div class="search-popup" id="search-popup"></div>
                </div>
                <ul class="nav-menu" id="nav-menu">
                    <li><a href="#">Home</a></li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle">Genre</a>
                        <ul class="dropdown-menu" id="genre-menu">
                            <!-- Genres loaded dynamically via script.js -->
                        </ul>
                    </li>
                    <li><a href="#">Movies</a></li>
                    <li><a href="#">Series</a></li>
                    <li><a href="#">About</a></li>
                    <li>
                        <a href="#" class="btn btn-hover">
                            <span>Profile</span>
                        </a>
                    </li>
                    <li>
                        <button id="theme-toggle" class="theme-toggle-btn" aria-label="Toggle theme">
                            <span class="material-icons">brightness_4</span>
                        </button>
                    </li>
                    <li id="partyStatusIndicator" class="hidden">
                        <span class="party-status-badge">
                            <i class='bx bx-group'></i>
                            <span class="party-status-text">In Party</span>
                        </span>
                    </li>
                </ul>
                <div class="hamburger-menu" id="hamburger-menu" role="button" aria-label="Toggle navigation" aria-expanded="false">
                    <div class="hamburger"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main">
        <!-- Left Column -->
        <div class="left-column">
            <!-- Video Player -->
            <div id="videoPlayer" class="video_player" role="region" aria-label="Video player">
                <div class="error-overlay hidden" aria-live="assertive">
                    <span class="error-message"></span>
                </div>
                <div class="loading-spinner hidden" aria-label="Loading video"></div>
                <button id="liveButton" class="hidden" aria-label="Go to live">LIVE</button>
                <div class="context-menu hidden" aria-hidden="true" style="display: none;">
                    <ul role="menu">
                        <li data-action="play-pause" role="menuitem" tabindex="0">Play/Pause</li>
                        <li data-action="toggle-pip" role="menuitem" tabindex="0">Picture-in-Picture</li>
                        <li data-action="toggle-fullscreen" role="menuitem" tabindex="0">Fullscreen</li>
                        <li data-action="share-video" role="menuitem" tabindex="0">Share Video</li>
                        <li data-action="create-clip" role="menuitem" tabindex="0">Create Clip</li>
                        <li data-action="add-bookmark" role="menuitem" tabindex="0">Add Bookmark</li>
                    </ul>
                </div>
                <div id="iframePlayerContainer" class="iframe-player-container" aria-label="Embedded video player">
                    <iframe id="iframePlayer" frameborder="0" allowfullscreen aria-label="Embedded video content"></iframe>
                </div>
                <button id="centerControl" class="center-control" aria-label="Play" role="button" tabindex="0">
                    <span class="material-icons">play_arrow</span>
                </button>
                <div id="qualityBadge" class="quality-badge" aria-live="polite">Auto</div>
                <div class="annotation-overlay" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 100;"></div>
                <button id="skipAdBtn" class="skip-ad-btn hidden" disabled aria-label="Skip advertisement">
                    <span class="skip-ad-text" id="skipAdTimer">Skip in 5s</span>
                    <span class="skip-ad-active">Skip Ad</span>
                </button>
                <div id="volumeOverlay" class="swipe-overlay hidden" aria-hidden="true">
                    <div id="volumeIndicator" class="swipe-indicator">
                        <span class="material-icons" id="volumeIcon">volume_up</span>
                        <span id="volumeValue">80%</span>
                    </div>
                    <div class="volume-bar"></div>
                </div>
                <div id="brightnessOverlay" class="swipe-overlay hidden" aria-hidden="true">
                    <div id="brightnessIndicator" class="swipe-indicator">
                        <span class="material-icons" id="brightnessIcon">brightness_5</span>
                        <span id="brightnessValue">100%</span>
                    </div>
                    <div class="brightness-bar"></div>
                </div>
                <div id="rewindIndicator" class="tap-indicator left hidden" aria-hidden="true">
                    <div class="tap-indicator-content">
                        <span class="material-icons">fast_rewind</span>
                        <span id="rewindValue">-10s</span>
                    </div>
                </div>
                <div id="forwardIndicator" class="tap-indicator right hidden" aria-hidden="true">
                    <div class="tap-indicator-content">
                        <span class="material-icons">fast_forward</span>
                        <span id="forwardValue">+10s</span>
                    </div>
                </div>
                <div id="adOverlay" class="ad-overlay hidden" aria-hidden="true">
                    <span id="adText" class="ad-label">Advertisement</span>
                    <span id="adTimer" class="ad-timer">5s</span>
                </div>
                <div id="chaptersOverlay" class="chapters-overlay"></div>
                <div class="controls hidden" role="toolbar">
                    <div id="progressArea" class="progress-area" role="slider" aria-valuemin="0" aria-label="Video progress">
                        <div class="bufferedBar"></div>
                        <div class="progress-bar"><span></span></div>
                    </div>
                    <div class="controls-list">
                        <div class="controls-left">
                            <button class="icon fast-rewind" aria-label="Rewind 10 seconds" role="button" tabindex="0">
                                <span class="material-icons">fast_rewind</span>
                            </button>
                            <div class="timer" aria-live="polite">
                                <span class="current" aria-label="Current time">0:00</span>/<span class="duration" aria-label="Total duration">0:00</span>
                            </div>
                        </div>
                        <div class="controls-right">
                            <div class="volume" role="group">
                                <button class="icon" aria-label="Toggle mute" role="button" tabindex="0">
                                    <span class="material-icons">volume_up</span>
                                </button>
                                <div class="volume-popup">
                                    <input type="range" class="volume-slider" min="0" max="100" value="80" aria-label="Volume control" role="slider">
                                    <span class="volume-percentage" aria-hidden="true">80%</span>
                                </div>
                            </div>
                            <button class="icon settingsBtn" id="settingsBtn" aria-label="Open settings" role="button" tabindex="0">
                                <span class="material-icons">settings</span>
                            </button>
                            <button class="icon captionsBtn" id="captionsBtn" aria-label="Open captions menu" role="button" tabindex="0">
                                <span class="material-icons">closed_caption</span>
                            </button>
                            <button class="icon picture_in_picture" aria-label="Toggle Picture-in-Picture" role="button" tabindex="0">
                                <span class="material-icons">picture_in_picture_alt</span>
                            </button>
                            <button class="icon theater-mode" aria-label="Toggle theater mode" role="button" tabindex="0">
                                <span class="material-icons">theater_comedy</span>
                            </button>
                            <button class="icon fullscreen" aria-label="Enter fullscreen" role="button" tabindex="0">
                                <span class="material-icons">fullscreen</span>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="settingsPanel" class="settings-panel-wrapper hidden" role="dialog" aria-label="Settings panel">
                    <div class="settings-panel active" data-label="settingHome" aria-expanded="true">
                        <div class="settings-header">Settings</div>
                        <ul role="menu">
                            <li data-label="playbackSpeed" role="menuitem" tabindex="0" aria-label="Open playback speed menu">Playback Speed</li>
                            <li data-label="qualityMenu" role="menuitem" tabindex="0" aria-label="Open video quality menu">Quality</li>
                            <li data-label="chaptersMenu" role="menuitem" tabindex="0" aria-label="Open chapters menu">Chapters</li>
                            <li id="autoQualityToggle" class="active" role="menuitem" tabindex="0" aria-label="Toggle auto quality">Auto Quality <span class="material-icons">check</span></li>
                            <li data-label="statsForNerds" role="menuitem" tabindex="0" aria-label="Show technical stats">Stats for Nerds</li>
                        </ul>
                    </div>
                    <div class="settings-panel" data-label="playbackSpeed" aria-expanded="false">
                        <div class="settings-header">
                            <span class="material-icons back-arrow" data-label="settingHome" role="button" aria-label="Back to main settings" tabindex="0">arrow_back</span> Playback Speed
                        </div>
                        <ul role="menu">
                            <li data-speed="0.25" role="menuitem" tabindex="0" aria-label="Set playback speed to 0.25x">0.25x</li>
                            <li data-speed="0.5" role="menuitem" tabindex="0" aria-label="Set playback speed to 0.5x">0.5x</li>
                            <li data-speed="0.75" role="menuitem" tabindex="0" aria-label="Set playback speed to 0.75x">0.75x</li>
                            <li data-speed="1" class="active" role="menuitem" tabindex="0" aria-label="Set playback speed to 1x">1x <span class="material-icons">check</span></li>
                            <li data-speed="1.25" role="menuitem" tabindex="0" aria-label="Set playback speed to 1.25x">1.25x</li>
                            <li data-speed="1.5" role="menuitem" tabindex="0" aria-label="Set playback speed to 1.5x">1.5x</li>
                            <li data-speed="1.75" role="menuitem" tabindex="0" aria-label="Set playback speed to 1.75x">1.75x</li>
                            <li data-speed="2" role="menuitem" tabindex="0" aria-label="Set playback speed to 2x">2x</li>
                        </ul>
                    </div>
                    <div class="settings-panel" data-label="qualityMenu" aria-expanded="false">
                        <div class="settings-header">
                            <span class="material-icons back-arrow" data-label="settingHome" role="button" aria-label="Back to main settings" tabindex="0">arrow_back</span> Video Quality
                        </div>
                        <ul id="qualityMenu" role="menu"></ul>
                    </div>
                    <div class="settings-panel" data-label="chaptersMenu" aria-expanded="false">
                        <div class="settings-header">
                            <span class="material-icons back-arrow" data-label="settingHome" role="button" aria-label="Back to main settings" tabindex="0">arrow_back</span> Chapters
                        </div>
                        <ul id="chaptersMenu" role="menu"></ul>
                    </div>
                    <div class="settings-panel" data-label="statsForNerds" aria-expanded="false">
                        <div class="settings-header">
                            <span class="material-icons back-arrow" data-label="settingHome" role="button" aria-label="Back to main settings" tabindex="0">arrow_back</span> Stats for Nerds
                        </div>
                        <div class="stats-container">
                            <div class="stat-item">
                                <span class="stat-label">Resolution:</span>
                                <span class="stat-value" id="stat-resolution"></span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Bitrate:</span>
                                <span class="stat-value" id="stat-bitrate"></span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Codecs:</span>
                                <span class="stat-value" id="stat-codecs"></span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Buffer Health:</span>
                                <span class="stat-value" id="stat-buffer"></span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Dropped Frames:</span>
                                <span class="stat-value" id="stat-dropped"></span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Network Activity:</span>
                                <span class="stat-value" id="stat-network"></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="captions-panel-wrapper hidden" id="captionsPanel" role="dialog" aria-label="Subtitles panel">
                    <div class="settings-header">Subtitles</div>
                    <ul id="captionMenu" role="menu"></ul>
                </div>
                <div class="audio-tracks hidden" id="audioTracksPanel" role="dialog" aria-label="Audio tracks panel">
                    <div class="settings-header">Audio Tracks</div>
                    <ul id="audioTrackMenu" role="menu"></ul>
                </div>
                <div class="annotation-panel hidden" id="annotationPanel" role="dialog" aria-label="Annotations panel">
                    <div class="settings-header">Annotations</div>
                    <ul id="annotationMenu" role="menu"></ul>
                </div>
                <div class="playlist-panel hidden" id="playlistPanel" role="dialog" aria-label="Playlist panel">
                    <div class="settings-header">Playlist</div>
                    <ul id="playlistMenu" role="menu"></ul>
                </div>
                <div class="download-queue-panel hidden" id="downloadQueuePanel" role="dialog" aria-label="Download queue panel">
                    <div class="settings-header">Download Queue</div>
                    <ul id="downloadQueueMenu" role="menu"></ul>
                </div>
                <div class="bookmark-panel hidden" id="bookmarkPanel" role="dialog" aria-label="Bookmarks panel">
                    <div class="settings-header">Bookmarks</div>
                    <ul id="bookmarkMenu" role="menu"></ul>
                </div>
                <div id="keyboardShortcutsOverlay" class="hidden" aria-hidden="true">
                    <div class="settings-header">Keyboard Shortcuts</div>
                    <ul>
                        <li>Space: Play/Pause</li>
                        <li>K: Play/Pause</li>
                        <li>F: Toggle Fullscreen</li>
                        <li>M: Toggle Mute</li>
                        <li>←/→: Seek 5 seconds</li>
                        <li>↑/↓: Volume control</li>
                        <li>J: Rewind 10 seconds</li>
                        <li>L: Forward 10 seconds</li>
                        <li>0-9: Jump to percentage</li>
                        <li>C: Toggle captions</li>
                        <li>Shift+>: Increase speed</li>
                        <li>Shift+<: Decrease speed</li>
                    </ul>
                </div>
                <div id="lockOverlay" class="hidden" aria-hidden="true">
                    <span class="material-icons">lock</span>
                </div>
                <div id="orientationFeedback" class="hidden" aria-hidden="true">
                    <span>Rotate Device</span>
                </div>
                <div class="mobile-controls-overlay" id="mobileControlsOverlay"></div>
            </div>

            <!-- Engagement buttons -->
            <div class="engagement-buttons">
                <button class="engagement-btn" id="likeBtn" aria-label="Like this video">
                    <i class='bx bx-like'></i>
                    <span>Like</span>
                    <span class="count" id="likeCount">0</span>
                </button>
                <button class="engagement-btn" id="dislikeBtn" aria-label="Dislike this video">
                    <i class='bx bx-dislike'></i>
                    <span>Dislike</span>
                    <span class="count" id="dislikeCount">0</span>
                </button>
                <button class="engagement-btn" id="favoriteBtn" aria-label="Add to favorites">
                    <i class='bx bx-heart'></i>
                    <span>Favorite</span>
                </button>
                <button class="engagement-btn" id="watchLaterBtn" aria-label="Add to watch later">
                    <i class='bx bx-time'></i>
                    <span>Watch Later</span>
                </button>
                <button class="engagement-btn" id="videoShareBtn" aria-label="Share this video">
                    <i class='bx bx-share-alt'></i>
                    <span>Share</span>
                </button>
            </div>

            <!-- Watch party section - Enhanced -->
            <div class="watch-party-section">
                <div class="watch-party-header">
                    <h3><i class='bx bx-group'></i> Watch Party</h3>
                    <div class="party-status" id="currentPartyStatus">
                        <span>Not in a party</span>
                    </div>
                </div>
                <p>Sync your viewing experience with friends and chat live!</p>
                <div class="watch-party-buttons">
                    <button class="btn" id="createPartyBtn" aria-label="Create watch party">
                        <i class='bx bx-plus'></i> Create Party
                    </button>
                    <button class="btn outline" id="joinPartyBtn" aria-label="Join watch party">
                        <i class='bx bx-group'></i> Join Party
                    </button>
                    <button class="btn danger hidden" id="leavePartyBtnTop" aria-label="Leave watch party">
                        <i class='bx bx-exit'></i> Leave Party
                    </button>
                </div>
                <div class="party-info hidden" id="partyInfoContainer">
                    <div class="party-info-item">
                        <span>Party Name:</span>
                        <strong id="partyNameDisplay">Movie Night</strong>
                    </div>
                    <div class="party-info-item">
                        <span>Members:</span>
                        <strong id="partyMemberCount">1</strong>
                    </div>
                    <div class="party-info-item">
                        <span>Code:</span>
                        <strong id="partyCodeDisplay">ABCD12</strong>
                        <button class="copy-btn" id="copyPartyCodeBtn" aria-label="Copy party code">
                            <i class='bx bx-copy'></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Live Chat Section -->
            <div class="live-chat-section" id="liveChatSection">
                <div class="chat-header">
                    <h3><i class='bx bx-chat'></i> Live Chat</h3>
                    <div class="chat-controls">
                        <button class="chat-control-btn" id="toggleChatBtn" aria-label="Toggle chat">
                            <i class='bx bx-chevron-down'></i>
                        </button>
                    </div>
                </div>
                <div class="chat-container" id="chatContainer">
                    <div class="chat-messages" id="chatMessages">
                        <div class="system-message">
                            Welcome to the live chat! Be nice to each other.
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <input type="text" id="chatInput" placeholder="Type your message..." aria-label="Chat input">
                        <button id="sendChatBtn" aria-label="Send message">
                            <i class='bx bx-send'></i>
                        </button>
                    </div>
                    <div class="chat-emoji-picker" id="emojiPicker">
                        <button class="emoji-btn" data-emoji="😀">😀</button>
                        <button class="emoji-btn" data-emoji="😂">😂</button>
                        <button class="emoji-btn" data-emoji="😍">😍</button>
                        <button class="emoji-btn" data-emoji="😎">😎</button>
                        <button class="emoji-btn" data-emoji="👍">👍</button>
                        <button class="emoji-btn" data-emoji="❤️">❤️</button>
                        <button class="emoji-btn" data-emoji="🎉">🎉</button>
                        <button class="emoji-btn" data-emoji="🔥">🔥</button>
                        <button class="emoji-btn" id="moreEmojisBtn" aria-label="More emojis">
                            <i class='bx bx-dots-horizontal-rounded'></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Party Chat Section (shown only when in party) -->
            <div class="party-chat-section hidden" id="partyChatSection">
                <div class="chat-header">
                    <h3><i class='bx bx-party'></i> Party Chat</h3>
                    <div class="chat-controls">
                        <button class="chat-control-btn" id="togglePartyChatBtn" aria-label="Toggle party chat">
                            <i class='bx bx-chevron-down'></i>
                        </button>
                    </div>
                </div>
                <div class="chat-container" id="partyChatContainer">
                    <div class="chat-messages" id="partyChatMessages">
                        <div class="system-message">
                            Welcome to the party chat! Only party members can see these messages.
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <input type="text" id="partyChatInput" placeholder="Type to party..." aria-label="Party chat input">
                        <button id="sendPartyChatBtn" aria-label="Send party message">
                            <i class='bx bx-send'></i>
                        </button>
                    </div>
                    <div class="party-chat-actions">
                        <button class="party-chat-action-btn" id="partySyncBtn" aria-label="Sync video with party">
                            <i class='bx bx-reset'></i> Sync
                        </button>
                        <button class="party-chat-action-btn" id="partyReactionBtn" aria-label="Send reaction">
                            <i class='bx bx-happy'></i> Reaction
                        </button>
                    </div>
                </div>
            </div>

            <!-- Chapters navigation -->
            <div class="chapters-container">
                <h3>Chapters</h3>
                <div class="chapters-scroller" id="chapters-scroller">
                    <!-- Chapters loaded dynamically via script.js -->
                </div>
            </div>

            <!-- Enhanced controls -->
            <div class="enhanced-controls">
                <button class="enhanced-control-btn" id="clipBtn" aria-label="Create clip">
                    <i class='bx bx-cut'></i>
                    <span>Create Clip</span>
                </button>
                <button class="enhanced-control-btn" id="bookmarkBtn" aria-label="Add bookmark">
                    <i class='bx bx-bookmark'></i>
                    <span>Bookmark</span>
                </button>
                <button class="enhanced-control-btn" id="loopBtn" aria-label="Toggle loop">
                    <i class='bx bx-repeat'></i>
                    <span>Loop</span>
                </button>
                <button class="enhanced-control-btn" id="audioBoostBtn" aria-label="Toggle audio boost">
                    <i class='bx bx-volume-full'></i>
                    <span>Audio Boost</span>
                </button>
                <button class="enhanced-control-btn" id="nightModeBtn" aria-label="Toggle night mode">
                    <i class='bx bx-moon'></i>
                    <span>Night Mode</span>
                </button>
            </div>

            <!-- Reaction buttons -->
            <div class="reaction-buttons">
                <button class="reaction-btn" data-reaction="laugh" aria-label="React with laugh">
                    <img src="https://cdn.jsdelivr.net/npm/twemoji@11.3.0/2/svg/1f602.svg" alt="Laughing emoji" loading="lazy">
                </button>
                <button class="reaction-btn" data-reaction="love" aria-label="React with love">
                    <img src="https://cdn.jsdelivr.net/npm/twemoji@11.3.0/2/svg/1f60d.svg" alt="Love emoji" loading="lazy">
                </button>
                <button class="reaction-btn" data-reaction="wow" aria-label="React with wow">
                    <img src="https://cdn.jsdelivr.net/npm/twemoji@11.3.0/2/svg/1f62e.svg" alt="Wow emoji" loading="lazy">
                </button>
                <button class="reaction-btn" data-reaction="sad" aria-label="React with sad">
                    <img src="https://cdn.jsdelivr.net/npm/twemoji@11.3.0/2/svg/1f622.svg" alt="Sad emoji" loading="lazy">
                </button>
                <button class="reaction-btn" data-reaction="angry" aria-label="React with angry">
                    <img src="https://cdn.jsdelivr.net/npm/twemoji@11.3.0/2/svg/1f620.svg" alt="Angry emoji" loading="lazy">
                </button>
            </div>

            <!-- Content Details -->
            <section class="movie-detail" id="movie-detail" data-content-id="">
                <div class="movie-detail-content">
                    <h1 class="detail-title" id="content-title"></h1>
                    <div class="meta-wrapper">
                        <div class="badge-wrapper">
                            <div class="badge badge-fill" id="content-rating"></div>
                            <div class="badge badge-outline" id="content-quality"></div>
                            <div class="badge badge-outline" id="content-resolution"></div>
                            <div class="badge badge-outline" id="content-audio"></div>
                        </div>
                        <div class="ganre-wrapper" id="content-genres"></div>
                        <div class="date-time">
                            <div>
                                <i class='bx bx-calendar'></i>
                                <time id="content-year"></time>
                            </div>
                            <div>
                                <i class='bx bx-time'></i>
                                <time id="content-duration"></time>
                            </div>
                            <div>
                                <i class='bx bx-camera-movie'></i>
                                <span id="content-director"></span>
                            </div>
                        </div>
                    </div>
                    <div class="rating-section">
                        <div class="imdb-rating">
                            <img src="/assets/images/imdb-logo.png" alt="IMDb logo" loading="lazy">
                            <span id="imdb-rating"></span>
                        </div>
                        <div class="user-rating">
                            <div class="stars" id="user-stars"></div>
                            <span id="review-count"></span>
                        </div>
                    </div>
                    <p class="storyline" id="content-description"></p>
                    <div class="details-actions">
                        <button class="share" id="contentShareBtn" aria-label="Share content">
                            <i class='bx bx-share-alt'></i>
                            <span>Share</span>
                        </button>
                        <div class="download-btn-container">
                            <button id="hdDownloadBtn" aria-label="Download in HD quality">
                                <i class='bx bx-download'></i> HD Download
                            </button>
                        </div>
                        <div class="download-btn-container">
                            <button id="fastDownloadBtn" aria-label="Download quickly">
                                <i class='bx bx-cloud-download'></i> Fast Download
                            </button>
                        </div>
                        <div class="download-btn-container">
                            <button id="subtitlesDownloadBtn" aria-label="Download subtitles">
                                <i class='bx bx-captions'></i> Subtitles
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Reviews Section -->
            <section class="reviews-section">
                <h2 class="section-title">User Reviews</h2>
                <form id="review-form" class="review-form" aria-label="Submit a review">
                    <h3>Share Your Thoughts</h3>
                    <div class="rating-input">
                        <span>Your Rating:</span>
                        <div class="star-rating">
                            <i class='bx bx-star' data-rating="1" role="button" aria-label="Rate 1 star"></i>
                            <i class='bx bx-star' data-rating="2" role="button" aria-label="Rate 2 stars"></i>
                            <i class='bx bx-star' data-rating="3" role="button" aria-label="Rate 3 stars"></i>
                            <i class='bx bx-star' data-rating="4" role="button" aria-label="Rate 4 stars"></i>
                            <i class='bx bx-star' data-rating="5" role="button" aria-label="Rate 5 stars"></i>
                        </div>
                    </div>
                    <textarea placeholder="Write your review here..." required aria-label="Write your review"></textarea>
                    <button type="submit" aria-label="Submit review">
                        <i class='bx bx-send'></i> Submit Review
                    </button>
                </form>
                <div class="reviews-list" id="user-reviews"></div>
            </section>

            <!-- Cast Section -->
            <section class="cast-section">
                <h2 class="section-title">Cast</h2>
                <button class="nav-arrow nav-arrow-left" aria-label="Scroll cast left">
                    <span class="material-icons">chevron_left</span>
                </button>
                <div class="cast-grid" id="cast-grid"></div>
                <button class="nav-arrow nav-arrow-right" aria-label="Scroll cast right">
                    <span class="material-icons">chevron_right</span>
                </button>
            </section>
        </div>

        <!-- Right Column -->
        <div class="right-column">
            <h2 class="section-title">Recommended Videos</h2>
            <div id="recommended-videos" class="recommended-videos"></div>
            
            <!-- Party Members Sidebar (shown only when in party) -->
            <div class="party-members-sidebar hidden" id="partyMembersSidebar">
                <h3 class="sidebar-title">
                    <i class='bx bx-group'></i> Party Members
                    <span class="member-count" id="partyMemberCountSidebar">1</span>
                </h3>
                <ul class="member-list" id="partyMemberList">
                    <li class="member-item host">
                        <div class="member-avatar">
                            <i class='bx bx-user'></i>
                        </div>
                        <div class="member-info">
                            <span class="member-name">You (Host)</span>
                            <span class="member-status">Online</span>
                        </div>
                        <div class="member-actions">
                            <button class="member-action-btn" aria-label="Member options">
                                <i class='bx bx-dots-vertical-rounded'></i>
                            </button>
                        </div>
                    </li>
                </ul>
                <div class="party-admin-controls" id="partyAdminControls">
                    <h4>Host Controls</h4>
                    <button class="admin-control-btn" id="partyKickBtn" aria-label="Kick member">
                        <i class='bx bx-user-x'></i> Kick
                    </button>
                    <button class="admin-control-btn" id="partyMuteBtn" aria-label="Mute member">
                        <i class='bx bx-microphone-off'></i> Mute
                    </button>
                    <button class="admin-control-btn" id="partyTransferHostBtn" aria-label="Transfer host">
                        <i class='bx bx-transfer'></i> Transfer Host
                    </button>
                    <button class="admin-control-btn" id="partyLockBtn" aria-label="Lock party">
                        <i class='bx bx-lock'></i> Lock Party
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-top">
            <div class="container">
                <div class="footer-brand-wrapper">
                    <a href="/" class="logo" aria-label="Homepage">
                        <img src="/assets/images/logo.svg" alt="Platform logo" loading="lazy">
                    </a>
                    <ul class="footer-list">
                        <li><a href="/home" class="footer-link">Home</a></li>
                        <li><a href="/movies" class="footer-link">Movies</a></li>
                        <li><a href="/series" class="footer-link">Series</a></li>
                        <li><a href="/pricing" class="footer-link">Pricing</a></li>
                    </ul>
                </div>
                <div class="divider"></div>
                <div class="quicklink-wrapper">
                    <ul class="quicklink-list">
                        <li><a href="/faq" class="quicklink-link">FAQ</a></li>
                        <li><a href="/help" class="quicklink-link">Help Center</a></li>
                        <li><a href="/terms" class="quicklink-link">Terms of Use</a></li>
                        <li><a href="/privacy" class="quicklink-link">Privacy</a></li>
                    </ul>
                    <ul class="social-list">
                        <li><a href="#" class="social-link" aria-label="Facebook"><ion-icon name="logo-facebook"></ion-icon></a></li>
                        <li><a href="#" class="social-link" aria-label="Twitter"><ion-icon name="logo-twitter"></ion-icon></a></li>
                        <li><a href="#" class="social-link" aria-label="Pinterest"><ion-icon name="logo-pinterest"></ion-icon></a></li>
                        <li><a href="#" class="social-link" aria-label="LinkedIn"><ion-icon name="logo-linkedin"></ion-icon></a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="container">
                <p class="copyright">© 2025 <a href="/">StreamX</a>. All Rights Reserved</p>
                <img src="/assets/images/footer-bottom-img.png" alt="Online banking companies logo" class="footer-bottom-img" loading="lazy">
            </div>
        </div>
    </footer>

    <!-- Watch Party Popup - Enhanced -->
    <div class="watch-party-popup" id="watchPartyPopup">
        <div class="party-popup-content">
            <div class="party-popup-header">
                <h3><i class='bx bx-party'></i> Watch Party</h3>
                <button class="close-popup" id="closePartyPopup" aria-label="Close party popup">×</button>
            </div>
            <div class="party-popup-body">
                <div class="party-tab-buttons">
                    <button class="party-tab active" data-tab="create">Create Party</button>
                    <button class="party-tab" data-tab="join">Join Party</button>
                    <button class="party-tab" data-tab="active" id="activePartyTab" style="display: none;">Party Controls</button>
                </div>
                
                <!-- Create Party Tab -->
                <div class="party-tab-content active" data-tab-content="create">
                    <div class="party-form-group">
                        <label for="partyName">Party Name</label>
                        <input type="text" id="partyName" placeholder="Enter a name for your party">
                    </div>
                    <div class="party-form-group">
                        <label for="partyPassword">Password (optional)</label>
                        <input type="password" id="partyPassword" placeholder="Set a password">
                    </div>
                    <div class="party-form-group">
                        <label for="hostControls">Host Controls</label>
                        <select id="hostControls">
                            <option value="full">Full Control (Play/Pause, Seek, Sync)</option>
                            <option value="limited">Limited (Sync Only)</option>
                            <option value="democratic">Democratic (Vote-based controls)</option>
                        </select>
                    </div>
                    <div class="party-form-group">
                        <label for="partyPrivacy">Privacy Settings</label>
                        <select id="partyPrivacy">
                            <option value="public">Public (Anyone can join)</option>
                            <option value="invite">Invite-only</option>
                            <option value="private">Private (Hidden from listings)</option>
                        </select>
                    </div>
                    <div class="party-form-actions">
                        <button class="btn outline" id="cancelCreateParty">Cancel</button>
                        <button class="btn" id="confirmCreateParty">Create Party</button>
                    </div>
                </div>
                
                <!-- Join Party Tab -->
                <div class="party-tab-content" data-tab-content="join">
                    <div class="party-browse-section">
                        <h4>Browse Public Parties</h4>
                        <div class="public-parties-list" id="publicPartiesList">
                            <div class="party-item">
                                <div class="party-item-info">
                                    <h5>Movie Night</h5>
                                    <p>Watching: Avengers: Endgame</p>
                                    <div class="party-meta">
                                        <span><i class='bx bx-user'></i> 5</span>
                                        <span><i class='bx bx-lock-open'></i> Public</span>
                                    </div>
                                </div>
                                <button class="btn join-party-btn">Join</button>
                            </div>
                            <!-- More parties will be loaded dynamically -->
                        </div>
                    </div>
                    <div class="party-join-section">
                        <h4>Join with Code</h4>
                        <div class="party-form-group">
                            <label for="partyCode">Party Code</label>
                            <input type="text" id="partyCode" placeholder="Enter party code">
                        </div>
                        <div class="party-form-group">
                            <label for="joinPassword">Password (if required)</label>
                            <input type="password" id="joinPassword" placeholder="Enter password">
                        </div>
                        <div class="party-form-actions">
                            <button class="btn outline" id="cancelJoinParty">Cancel</button>
                            <button class="btn" id="confirmJoinParty">Join Party</button>
                        </div>
                    </div>
                </div>
                
                <!-- Active Party View -->
                <div class="party-tab-content" data-tab-content="active" style="display: none;">
                    <div class="party-active-info">
                        <h4 id="activePartyName">Movie Night</h4>
                        <div class="party-active-meta">
                            <span>Code: <strong id="activePartyCode">ABCD12</strong></span>
                            <button class="copy-btn" id="copyActivePartyCodeBtn">
                                <i class='bx bx-copy'></i> Copy
                            </button>
                        </div>
                        <div class="party-active-status">
                            <span>Status: <strong id="activePartyStatus">Active</strong></span>
                            <span>Members: <strong id="activePartyMemberCount">1</strong></span>
                        </div>
                    </div>
                    
                    <div class="party-chat-container">
                        <div class="party-chat-messages" id="popupPartyChatMessages"></div>
                        <div class="party-chat-input">
                            <input type="text" id="popupPartyChatInput" placeholder="Type a message...">
                            <button id="popupSendPartyMessage">
                                <i class='bx bx-send'></i>
                            </button>
                        </div>
                    </div>
                    
                    <h4>Party Controls</h4>
                    <div class="party-controls-grid">
                        <button class="party-control-btn" id="popupPartyPlayPause" data-host-only="true">
                            <i class='bx bx-play'></i>
                            <span>Play/Pause</span>
                        </button>
                        <button class="party-control-btn" id="popupPartySeekBack" data-host-only="true">
                            <i class='bx bx-rewind'></i>
                            <span>Seek -10s</span>
                        </button>
                        <button class="party-control-btn" id="popupPartySeekForward" data-host-only="true">
                            <i class='bx bx-fast-forward'></i>
                            <span>Seek +10s</span>
                        </button>
                        <button class="party-control-btn" id="popupPartySync">
                            <i class='bx bx-reset'></i>
                            <span>Sync All</span>
                        </button>
                        <button class="party-control-btn" id="popupPartyChangeVideo" data-host-only="true">
                            <i class='bx bx-video'></i>
                            <span>Change Video</span>
                        </button>
                        <button class="party-control-btn" id="popupPartySettings" data-host-only="true">
                            <i class='bx bx-cog'></i>
                            <span>Settings</span>
                        </button>
                    </div>
                    
                    <div class="party-members-container">
                        <h4>Party Members</h4>
                        <ul class="party-members-list" id="popupPartyMembersList">
                            <!-- Members will be loaded dynamically -->
                        </ul>
                    </div>
                    
                    <button class="leave-party-btn" id="popupLeavePartyBtn">
                        <i class='bx bx-exit'></i> Leave Party
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Party Settings Modal -->
    <div class="modal" id="partySettingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Party Settings</h3>
                <button class="close-modal" id="closePartySettingsModal">×</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h4>General Settings</h4>
                    <div class="setting-item">
                        <label for="partyNameSetting">Party Name</label>
                        <input type="text" id="partyNameSetting" value="Movie Night">
                    </div>
                    <div class="setting-item">
                        <label for="partyPrivacySetting">Privacy</label>
                        <select id="partyPrivacySetting">
                            <option value="public">Public</option>
                            <option value="invite">Invite-only</option>
                            <option value="private">Private</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label for="partyPasswordSetting">Change Password</label>
                        <input type="password" id="partyPasswordSetting" placeholder="Leave blank to remove">
                    </div>
                </div>
                
                <div class="settings-section">
                    <h4>Playback Controls</h4>
                    <div class="setting-item">
                        <label for="syncTolerance">Sync Tolerance</label>
                        <select id="syncTolerance">
                            <option value="strict">Strict (Exact sync)</option>
                            <option value="normal" selected>Normal (±2 seconds)</option>
                            <option value="loose">Loose (±5 seconds)</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label for="controlMode">Control Mode</label>
                        <select id="controlMode">
                            <option value="host">Host Only</option>
                            <option value="democratic">Democratic (Voting)</option>
                            <option value="free">Free for All</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="enableReactions" checked>
                            Enable Reactions
                        </label>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h4>Advanced</h4>
                    <div class="setting-item">
                        <label for="maxMembers">Max Members</label>
                        <input type="number" id="maxMembers" min="2" max="50" value="20">
                    </div>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="allowGuests">
                            Allow Guest Join (no account needed)
                        </label>
                    </div>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="autoSyncOnJoin" checked>
                            Auto-sync New Members
                        </label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn outline" id="cancelPartySettings">Cancel</button>
                <button class="btn" id="savePartySettings">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Reaction Picker -->
    <div class="reaction-picker" id="reactionPicker">
        <div class="reaction-options">
            <button class="reaction-option" data-reaction="😀">😀</button>
            <button class="reaction-option" data-reaction="😂">😂</button>
            <button class="reaction-option" data-reaction="😍">😍</button>
            <button class="reaction-option" data-reaction="😎">😎</button>
            <button class="reaction-option" data-reaction="👍">👍</button>
            <button class="reaction-option" data-reaction="👎">👎</button>
            <button class="reaction-option" data-reaction="❤️">❤️</button>
            <button class="reaction-option" data-reaction="🎉">🎉</button>
            <button class="reaction-option" data-reaction="🔥">🔥</button>
            <button class="reaction-option" data-reaction="🤔">🤔</button>
            <button class="reaction-option" data-reaction="😢">😢</button>
            <button class="reaction-option" data-reaction="😡">😡</button>
        </div>
    </div>

    <!-- Invite Friends Modal -->
    <div class="modal" id="inviteFriendsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Invite Friends</h3>
                <button class="close-modal" id="closeInviteFriendsModal">×</button>
            </div>
            <div class="modal-body">
                <div class="invite-method-tabs">
                    <button class="invite-tab active" data-tab="link">Share Link</button>
                    <button class="invite-tab" data-tab="friends">Friends</button>
                    <button class="invite-tab" data-tab="social">Social Media</button>
                </div>
                
                <div class="invite-tab-content active" data-tab-content="link">
                    <div class="invite-link-container">
                        <input type="text" id="partyInviteLink" value="https://streamx.com/party/join/ABCD12" readonly>
                        <button class="btn" id="copyInviteLink">
                            <i class='bx bx-copy'></i> Copy
                        </button>
                    </div>
                    <div class="invite-qr-code">
                        <div id="partyInviteQrCode"></div>
                        <p>Scan to join</p>
                    </div>
                </div>
                
                <div class="invite-tab-content" data-tab-content="friends">
                    <div class="friends-search">
                        <input type="text" placeholder="Search friends..." id="friendsSearchInput">
                    </div>
                    <ul class="friends-list" id="friendsList">
                        <!-- Friends will be loaded dynamically -->
                    </ul>
                </div>
                
                <div class="invite-tab-content" data-tab-content="social">
                    <div class="social-share-buttons">
                        <button class="social-share-btn facebook">
                            <i class='bx bxl-facebook'></i> Facebook
                        </button>
                        <button class="social-share-btn twitter">
                            <i class='bx bxl-twitter'></i> Twitter
                        </button>
                        <button class="social-share-btn whatsapp">
                            <i class='bx bxl-whatsapp'></i> WhatsApp
                        </button>
                        <button class="social-share-btn telegram">
                            <i class='bx bxl-telegram'></i> Telegram
                        </button>
                        <button class="social-share-btn discord">
                            <i class='bx bxl-discord'></i> Discord
                        </button>
                        <button class="social-share-btn email">
                            <i class='bx bx-envelope'></i> Email
                        </button>
                    </div>
                    <div class="custom-message">
                        <label for="socialShareMessage">Custom Message</label>
                        <textarea id="socialShareMessage" rows="3">Join my watch party on StreamX! We're watching together right now. Click the link to join: https://streamx.com/party/join/ABCD12</textarea>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/assets/js/script.js"></script>
    <script src="/assets/js/party.js"></script>
    <script src="/assets/js/chat.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
</body>
</html>